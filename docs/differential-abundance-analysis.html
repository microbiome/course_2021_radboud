<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Differential abundance analysis | Introduction to microbiome data science</title>
  <meta name="description" content="Course material" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Differential abundance analysis | Introduction to microbiome data science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course material" />
  <meta name="github-repo" content="microbiome/course_2021_radboud" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Differential abundance analysis | Introduction to microbiome data science" />
  
  <meta name="twitter:description" content="Course material" />
  

<meta name="author" content="Leo Lahti, Tuomas Borman, Henrik Eckermann, Chouaib Benchraka" />


<meta name="date" content="2021-07-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beta-diversity.html"/>
<link rel="next" href="study-material.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to miaverse</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.2</b> Learning goals</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>1.3</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="program.html"><a href="program.html"><i class="fa fa-check"></i><b>2</b> Program</a><ul>
<li class="chapter" data-level="2.1" data-path="program.html"><a href="program.html#monday-12-july-from-raw-sequences-to-ecological-data-analysis"><i class="fa fa-check"></i><b>2.1</b> Monday 12 July: from raw sequences to ecological data analysis</a></li>
<li class="chapter" data-level="2.2" data-path="program.html"><a href="program.html#tuesday-13-july---alpha-diversity"><i class="fa fa-check"></i><b>2.2</b> Tuesday 13 July - Alpha diversity</a></li>
<li class="chapter" data-level="2.3" data-path="program.html"><a href="program.html#wednesday-14-july---beta-diversity"><i class="fa fa-check"></i><b>2.3</b> Wednesday 14 July - Beta diversity</a></li>
<li class="chapter" data-level="2.4" data-path="program.html"><a href="program.html#thursday-15-july---differential-abundance"><i class="fa fa-check"></i><b>2.4</b> Thursday 15 July - Differential abundance</a></li>
<li class="chapter" data-level="2.5" data-path="program.html"><a href="program.html#friday-16-july-presentations-closing"><i class="fa fa-check"></i><b>2.5</b> Friday 16 July: Presentations &amp; closing</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting started</a><ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#checklist-before-the-course"><i class="fa fa-check"></i><b>3.1</b> Checklist (before the course)</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#support-and-resources"><i class="fa fa-check"></i><b>3.2</b> Support and resources</a></li>
<li class="chapter" data-level="3.3" data-path="getting-started.html"><a href="getting-started.html#installing-and-loading-the-required-r-packages"><i class="fa fa-check"></i><b>3.3</b> Installing and loading the required R packages</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-microbiome-data.html"><a href="importing-microbiome-data.html"><i class="fa fa-check"></i><b>4</b> Importing microbiome data</a><ul>
<li class="chapter" data-level="4.1" data-path="importing-microbiome-data.html"><a href="importing-microbiome-data.html#data-access-and-example-of-importing-data"><i class="fa fa-check"></i><b>4.1</b> Data access and example of importing data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html"><i class="fa fa-check"></i><b>5</b> Microbiome data exploration</a><ul>
<li class="chapter" data-level="5.1" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#investigate"><i class="fa fa-check"></i><b>5.1</b> Investigate</a></li>
<li class="chapter" data-level="5.2" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#manipulate"><i class="fa fa-check"></i><b>5.2</b> Manipulate</a><ul>
<li class="chapter" data-level="5.2.1" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#transformations"><i class="fa fa-check"></i><b>5.2.1</b> Transformations</a></li>
<li class="chapter" data-level="5.2.2" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#aggregation"><i class="fa fa-check"></i><b>5.2.2</b> Aggregation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#visualize"><i class="fa fa-check"></i><b>5.3</b> Visualize</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="alpha-diversity.html"><a href="alpha-diversity.html"><i class="fa fa-check"></i><b>6</b> Alpha diversity</a><ul>
<li class="chapter" data-level="6.1" data-path="alpha-diversity.html"><a href="alpha-diversity.html#visualization"><i class="fa fa-check"></i><b>6.1</b> Visualization</a></li>
<li class="chapter" data-level="6.2" data-path="alpha-diversity.html"><a href="alpha-diversity.html#statistical-testing-and-comparisons"><i class="fa fa-check"></i><b>6.2</b> Statistical testing and comparisons</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="beta-diversity.html"><a href="beta-diversity.html"><i class="fa fa-check"></i><b>7</b> Beta diversity</a><ul>
<li class="chapter" data-level="7.1" data-path="beta-diversity.html"><a href="beta-diversity.html#examples-of-pcoa-with-different-settings"><i class="fa fa-check"></i><b>7.1</b> Examples of PCoA with different settings</a><ul>
<li class="chapter" data-level="7.1.1" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-for-asv-level-data-with-bray-curtis"><i class="fa fa-check"></i><b>7.1.1</b> PCoA for ASV-level data with Bray-Curtis</a></li>
<li class="chapter" data-level="7.1.2" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-for-asv-level-data-with-aitchison-distance"><i class="fa fa-check"></i><b>7.1.2</b> PCoA for ASV-level data with Aitchison distance</a></li>
<li class="chapter" data-level="7.1.3" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-aggregated-to-phylum-level"><i class="fa fa-check"></i><b>7.1.3</b> PCoA aggregated to Phylum level</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="beta-diversity.html"><a href="beta-diversity.html#highlighting-external-variables"><i class="fa fa-check"></i><b>7.2</b> Highlighting external variables</a><ul>
<li class="chapter" data-level="7.2.1" data-path="beta-diversity.html"><a href="beta-diversity.html#discrete-grouping-variable-shown-with-colors"><i class="fa fa-check"></i><b>7.2.1</b> Discrete grouping variable shown with colors</a></li>
<li class="chapter" data-level="7.2.2" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-plot-with-continuous-variable"><i class="fa fa-check"></i><b>7.2.2</b> PCoA plot with continuous variable</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="beta-diversity.html"><a href="beta-diversity.html#estimating-associations-with-an-external-variable"><i class="fa fa-check"></i><b>7.3</b> Estimating associations with an external variable</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html"><i class="fa fa-check"></i><b>8</b> Differential abundance analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#wilcoxon-test"><i class="fa fa-check"></i><b>8.1</b> Wilcoxon test</a></li>
<li class="chapter" data-level="8.2" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#deseq2"><i class="fa fa-check"></i><b>8.2</b> DESeq2</a></li>
<li class="chapter" data-level="8.3" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#ancom-bc"><i class="fa fa-check"></i><b>8.3</b> ANCOM-BC</a></li>
<li class="chapter" data-level="8.4" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#comparison-of-wilcoxon-test-and-deseq2"><i class="fa fa-check"></i><b>8.4</b> Comparison of Wilcoxon test and DESeq2</a></li>
<li class="chapter" data-level="8.5" data-path="differential-abundance-analysis.html"><a href="differential-abundance-analysis.html#comparison-of-abundance"><i class="fa fa-check"></i><b>8.5</b> Comparison of abundance</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="study-material.html"><a href="study-material.html"><i class="fa fa-check"></i><b>9</b> Study material</a><ul>
<li class="chapter" data-level="9.1" data-path="study-material.html"><a href="study-material.html#lecture-slides"><i class="fa fa-check"></i><b>9.1</b> Lecture slides</a></li>
<li class="chapter" data-level="9.2" data-path="study-material.html"><a href="study-material.html#example-solutions"><i class="fa fa-check"></i><b>9.2</b> Example solutions</a></li>
<li class="chapter" data-level="9.3" data-path="study-material.html"><a href="study-material.html#r-programming-resources"><i class="fa fa-check"></i><b>9.3</b> R programming resources</a></li>
<li class="chapter" data-level="9.4" data-path="study-material.html"><a href="study-material.html#resources-for-treesummarizedexperiment"><i class="fa fa-check"></i><b>9.4</b> Resources for TreeSummarizedExperiment</a></li>
<li class="chapter" data-level="9.5" data-path="study-material.html"><a href="study-material.html#resources-for-phyloseq"><i class="fa fa-check"></i><b>9.5</b> Resources for phyloseq</a></li>
<li class="chapter" data-level="9.6" data-path="study-material.html"><a href="study-material.html#further-reading"><i class="fa fa-check"></i><b>9.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="miscellaneous-material.html"><a href="miscellaneous-material.html"><i class="fa fa-check"></i><b>10</b> Miscellaneous material</a><ul>
<li class="chapter" data-level="10.1" data-path="miscellaneous-material.html"><a href="miscellaneous-material.html#shapiro-wilk-test"><i class="fa fa-check"></i><b>10.1</b> Shapiro-Wilk test</a></li>
<li class="chapter" data-level="10.2" data-path="miscellaneous-material.html"><a href="miscellaneous-material.html#deseq-details"><i class="fa fa-check"></i><b>10.2</b> Deseq details</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to microbiome data science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="differential-abundance-analysis" class="section level1">
<h1><span class="header-section-number">8</span> Differential abundance analysis</h1>
<p>Here, we analyse abundances with three different methods: <strong>Wilcoxon test</strong>, <strong>DESeq2</strong>,
and <strong>ANCOM-BC</strong>. All of these test statistical differences between groups.
We analyse Genus level abundances.</p>
<div id="wilcoxon-test" class="section level2">
<h2><span class="header-section-number">8.1</span> Wilcoxon test</h2>
<p>A Wilcoxon test estimates difference between two groups. It is a
non-parametric alternative to a t-test, which means that the Wilcoxon test
does not require normally distributed data.</p>
<p>Let’s first collect the data for the testing purpose.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="differential-abundance-analysis.html#cb52-1"></a><span class="co"># Agglomerates data to Genus level</span></span>
<span id="cb52-2"><a href="differential-abundance-analysis.html#cb52-2"></a>tse_genus &lt;-<span class="st"> </span><span class="kw">agglomerateByRank</span>(tse, <span class="dt">rank =</span> <span class="st">&quot;Genus&quot;</span>)</span>
<span id="cb52-3"><a href="differential-abundance-analysis.html#cb52-3"></a></span>
<span id="cb52-4"><a href="differential-abundance-analysis.html#cb52-4"></a><span class="co"># Does clr transformation. Pseudocount is added, because data contains zeros, and</span></span>
<span id="cb52-5"><a href="differential-abundance-analysis.html#cb52-5"></a><span class="co"># clr transformation includes log transformation.</span></span>
<span id="cb52-6"><a href="differential-abundance-analysis.html#cb52-6"></a>tse_genus &lt;-<span class="st"> </span><span class="kw">transformCounts</span>(tse_genus, <span class="dt">method =</span> <span class="st">&quot;clr&quot;</span>, <span class="dt">pseudocount =</span> <span class="dv">1</span>)</span>
<span id="cb52-7"><a href="differential-abundance-analysis.html#cb52-7"></a></span>
<span id="cb52-8"><a href="differential-abundance-analysis.html#cb52-8"></a><span class="co"># Does transpose, so samples are in rows, then creates a data frame.</span></span>
<span id="cb52-9"><a href="differential-abundance-analysis.html#cb52-9"></a>abundance_analysis_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">assay</span>(tse_genus, <span class="st">&quot;clr&quot;</span>)))</span>
<span id="cb52-10"><a href="differential-abundance-analysis.html#cb52-10"></a></span>
<span id="cb52-11"><a href="differential-abundance-analysis.html#cb52-11"></a><span class="co"># Then we need variable for grouping samples. &quot;patient_status&quot; column includes information</span></span>
<span id="cb52-12"><a href="differential-abundance-analysis.html#cb52-12"></a><span class="co"># about patients&#39; status. There two groups &quot;ADHD&quot; and &quot;control&quot;. Let&#39;s include that to the data frame.</span></span>
<span id="cb52-13"><a href="differential-abundance-analysis.html#cb52-13"></a>abundance_analysis_data &lt;-<span class="st"> </span><span class="kw">cbind</span>(abundance_analysis_data, </span>
<span id="cb52-14"><a href="differential-abundance-analysis.html#cb52-14"></a>                                 <span class="dt">patient_status =</span> <span class="kw">colData</span>(tse_genus)<span class="op">$</span>patient_status)</span></code></pre></div>
<p>Now we can do the Wilcoxon test. We test all the taxa by looping through columns,
and store individual p-values to a vector. Then we create a data frame from collected
data.</p>
<p>Code below does the Wilcoxon test only for columns that contain abundances,
not for column that contain patient status.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="differential-abundance-analysis.html#cb53-1"></a>colnames &lt;-<span class="st"> </span><span class="kw">names</span>(abundance_analysis_data[, <span class="op">!</span><span class="kw">names</span>(abundance_analysis_data) <span class="op">%in%</span><span class="st"> &quot;patient_status&quot;</span>])</span>
<span id="cb53-2"><a href="differential-abundance-analysis.html#cb53-2"></a></span>
<span id="cb53-3"><a href="differential-abundance-analysis.html#cb53-3"></a>wilcoxon_p &lt;-<span class="st"> </span><span class="kw">c</span>() <span class="co"># Initialize empty vector for p-values</span></span>
<span id="cb53-4"><a href="differential-abundance-analysis.html#cb53-4"></a></span>
<span id="cb53-5"><a href="differential-abundance-analysis.html#cb53-5"></a><span class="co"># Do for loop over selected column names</span></span>
<span id="cb53-6"><a href="differential-abundance-analysis.html#cb53-6"></a><span class="cf">for</span> (i <span class="cf">in</span> colnames) {</span>
<span id="cb53-7"><a href="differential-abundance-analysis.html#cb53-7"></a></span>
<span id="cb53-8"><a href="differential-abundance-analysis.html#cb53-8"></a>  result &lt;-<span class="st"> </span><span class="kw">wilcox.test</span>(abundance_analysis_data[, i] <span class="op">~</span><span class="st"> </span>patient_status,</span>
<span id="cb53-9"><a href="differential-abundance-analysis.html#cb53-9"></a>                        <span class="dt">data =</span> abundance_analysis_data)</span>
<span id="cb53-10"><a href="differential-abundance-analysis.html#cb53-10"></a>  </span>
<span id="cb53-11"><a href="differential-abundance-analysis.html#cb53-11"></a>  <span class="co"># Stores p-value to the vector with this column name</span></span>
<span id="cb53-12"><a href="differential-abundance-analysis.html#cb53-12"></a>  wilcoxon_p[[i]]  &lt;-<span class="st"> </span>result<span class="op">$</span>p.value</span>
<span id="cb53-13"><a href="differential-abundance-analysis.html#cb53-13"></a></span>
<span id="cb53-14"><a href="differential-abundance-analysis.html#cb53-14"></a>}</span>
<span id="cb53-15"><a href="differential-abundance-analysis.html#cb53-15"></a></span>
<span id="cb53-16"><a href="differential-abundance-analysis.html#cb53-16"></a>wilcoxon_p &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">taxa =</span>  <span class="kw">names</span>(wilcoxon_p),</span>
<span id="cb53-17"><a href="differential-abundance-analysis.html#cb53-17"></a>                         <span class="dt">p_raw =</span> <span class="kw">unlist</span>(wilcoxon_p))</span></code></pre></div>
<p>Multiple tests were performed. These are not independent, so we need
to adjust p-values for multiple testing. Otherwise, we would increase
the chance of a type I error drastically depending on our p-value
threshold. By applying a p-value adjustment, we can keep the false
positive rate at a level that is acceptable. What is acceptable
depends on our research goals. Here we use the fdr method, but there
are several other methods as well.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="differential-abundance-analysis.html#cb54-1"></a>wilcoxon_p<span class="op">$</span>p_adjusted &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(wilcoxon_p<span class="op">$</span>p_raw, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="differential-abundance-analysis.html#cb55-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(wilcoxon_p<span class="op">$</span>p_raw, wilcoxon_p<span class="op">$</span>p_adjusted), </span>
<span id="cb55-2"><a href="differential-abundance-analysis.html#cb55-2"></a>                <span class="dt">type=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;holm&quot;</span>),</span>
<span id="cb55-3"><a href="differential-abundance-analysis.html#cb55-3"></a>        <span class="kw">c</span>(<span class="kw">length</span>(wilcoxon_p<span class="op">$</span>p_raw),</span>
<span id="cb55-4"><a href="differential-abundance-analysis.html#cb55-4"></a>          <span class="kw">length</span>(wilcoxon_p<span class="op">$</span>p_adjusted))))</span>
<span id="cb55-5"><a href="differential-abundance-analysis.html#cb55-5"></a></span>
<span id="cb55-6"><a href="differential-abundance-analysis.html#cb55-6"></a>wilcoxon_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) <span class="op">+</span></span>
<span id="cb55-7"><a href="differential-abundance-analysis.html#cb55-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">fill=</span>type)) <span class="op">+</span></span>
<span id="cb55-8"><a href="differential-abundance-analysis.html#cb55-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;p-value&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Frequency&quot;</span>) </span>
<span id="cb55-9"><a href="differential-abundance-analysis.html#cb55-9"></a></span>
<span id="cb55-10"><a href="differential-abundance-analysis.html#cb55-10"></a>wilcoxon_plot</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="radboud2021_material_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="deseq2" class="section level2">
<h2><span class="header-section-number">8.2</span> DESeq2</h2>
<p>Our second analysis method is DESeq2. This performs the data
normalization automatically. It also takes care of the p-value
adjustment, so we don’t have to worry about that.</p>
<p>DESeq2 uses negative binomial distribution to detect differences in
read counts between groups. Its normalization takes care of the
differences between library sizes and compositions. DESeq2 analysis
includes multiple steps, but they are done automatically. More
information can be found, e.g., from Harvard Chan Bioinformatic Core’s
tutorial <a href="https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html">Introduction to DGE -
ARCHIVED</a></p>
<p>Now let us show how to do this. First, run the DESeq2 analysis.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="differential-abundance-analysis.html#cb57-1"></a><span class="co"># Creates DESeq2 object from the data. Uses &quot;patient_status&quot; to create groups. </span></span>
<span id="cb57-2"><a href="differential-abundance-analysis.html#cb57-2"></a>ds2 &lt;-<span class="st"> </span><span class="kw">DESeqDataSet</span>(tse_genus, <span class="op">~</span>patient_status)</span></code></pre></div>
<pre><code>## converting counts to integer mode</code></pre>
<pre><code>## Warning in DESeqDataSet(tse_genus, ~patient_status): 2 duplicate rownames were renamed by adding numbers</code></pre>
<pre><code>## Warning in DESeqDataSet(tse_genus, ~patient_status): some variables in design formula are characters, converting to
## factors</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="differential-abundance-analysis.html#cb61-1"></a><span class="co"># Does the analysis</span></span>
<span id="cb61-2"><a href="differential-abundance-analysis.html#cb61-2"></a>dds &lt;-<span class="st"> </span><span class="kw">DESeq</span>(ds2)</span></code></pre></div>
<pre><code>## estimating size factors</code></pre>
<pre><code>## estimating dispersions</code></pre>
<pre><code>## gene-wise dispersion estimates</code></pre>
<pre><code>## mean-dispersion relationship</code></pre>
<pre><code>## final dispersion estimates</code></pre>
<pre><code>## fitting model and testing</code></pre>
<pre><code>## -- replacing outliers and refitting for 11 genes
## -- DESeq argument &#39;minReplicatesForReplace&#39; = 7 
## -- original counts are preserved in counts(dds)</code></pre>
<pre><code>## estimating dispersions</code></pre>
<pre><code>## fitting model and testing</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="differential-abundance-analysis.html#cb71-1"></a><span class="co"># Gets the results from the object</span></span>
<span id="cb71-2"><a href="differential-abundance-analysis.html#cb71-2"></a>res &lt;-<span class="st"> </span><span class="kw">results</span>(dds)</span>
<span id="cb71-3"><a href="differential-abundance-analysis.html#cb71-3"></a></span>
<span id="cb71-4"><a href="differential-abundance-analysis.html#cb71-4"></a><span class="co"># Creates a data frame from results</span></span>
<span id="cb71-5"><a href="differential-abundance-analysis.html#cb71-5"></a>df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(res)</span>
<span id="cb71-6"><a href="differential-abundance-analysis.html#cb71-6"></a></span>
<span id="cb71-7"><a href="differential-abundance-analysis.html#cb71-7"></a><span class="co"># Adds taxon column that includes names of taxa</span></span>
<span id="cb71-8"><a href="differential-abundance-analysis.html#cb71-8"></a>df<span class="op">$</span>taxon &lt;-<span class="st"> </span><span class="kw">rownames</span>(df)</span>
<span id="cb71-9"><a href="differential-abundance-analysis.html#cb71-9"></a></span>
<span id="cb71-10"><a href="differential-abundance-analysis.html#cb71-10"></a><span class="co"># Orders the rows of data frame in increasing order firstly based on column &quot;log2FoldChange&quot; </span></span>
<span id="cb71-11"><a href="differential-abundance-analysis.html#cb71-11"></a><span class="co"># and secondly based on &quot;padj&quot; column</span></span>
<span id="cb71-12"><a href="differential-abundance-analysis.html#cb71-12"></a>df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(log2FoldChange, padj)</span>
<span id="cb71-13"><a href="differential-abundance-analysis.html#cb71-13"></a></span>
<span id="cb71-14"><a href="differential-abundance-analysis.html#cb71-14"></a><span class="kw">pandoc.table</span>(<span class="kw">as.matrix</span>(<span class="kw">head</span>(df)),<span class="dt">style=</span><span class="st">&quot;grid&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
## +-----------------------------------+------------+----------------+----------+
## |              &amp;nbsp;               |  baseMean  | log2FoldChange |  lfcSE   |
## +===================================+============+================+==========+
## | **Genus:Ruminococcaceae_UCG-014** | 22.548297  |   -24.891268   | 2.460684 |
## +-----------------------------------+------------+----------------+----------+
## |      **Order:Bacteroidales**      | 40.353733  |   -9.241798    | 2.136205 |
## +-----------------------------------+------------+----------------+----------+
## |    **Genus:Faecalibacterium**     | 231.079502 |   -7.074434    | 1.745612 |
## +-----------------------------------+------------+----------------+----------+
## |       **Genus:Catabacter**        | 18.045614  |   -6.615454    | 1.716150 |
## +-----------------------------------+------------+----------------+----------+
## |     **Genus:Butyricicoccus**      |  2.392885  |   -5.179608    | 2.948055 |
## +-----------------------------------+------------+----------------+----------+
## |   **Order:Gastranaerophilales**   |  2.067972  |   -3.054975    | 2.938641 |
## +-----------------------------------+------------+----------------+----------+
## 
## Table: Table continues below
## 
##  
## 
## +-----------------------------------+------------+--------------+
## |              &amp;nbsp;               |    stat    |    pvalue    |
## +===================================+============+==============+
## | **Genus:Ruminococcaceae_UCG-014** | -10.115589 | 4.711726e-24 |
## +-----------------------------------+------------+--------------+
## |      **Order:Bacteroidales**      | -4.326270  | 1.516556e-05 |
## +-----------------------------------+------------+--------------+
## |    **Genus:Faecalibacterium**     | -4.052694  | 5.063112e-05 |
## +-----------------------------------+------------+--------------+
## |       **Genus:Catabacter**        | -3.854823  | 1.158132e-04 |
## +-----------------------------------+------------+--------------+
## |     **Genus:Butyricicoccus**      | -1.756957  | 7.892506e-02 |
## +-----------------------------------+------------+--------------+
## |   **Order:Gastranaerophilales**   | -1.039588  | 2.985315e-01 |
## +-----------------------------------+------------+--------------+
## 
## Table: Table continues below
## 
##  
## 
## +-----------------------------------+--------------+
## |              &amp;nbsp;               |     padj     |
## +===================================+==============+
## | **Genus:Ruminococcaceae_UCG-014** | 2.544332e-22 |
## +-----------------------------------+--------------+
## |      **Order:Bacteroidales**      | 2.729801e-04 |
## +-----------------------------------+--------------+
## |    **Genus:Faecalibacterium**     | 6.835201e-04 |
## +-----------------------------------+--------------+
## |       **Genus:Catabacter**        | 1.250783e-03 |
## +-----------------------------------+--------------+
## |     **Genus:Butyricicoccus**      | 3.278426e-01 |
## +-----------------------------------+--------------+
## |   **Order:Gastranaerophilales**   | 7.269742e-01 |
## +-----------------------------------+--------------+
## 
## Table: Table continues below
## 
##  
## 
## +-----------------------------------+-------------------------------+
## |              &amp;nbsp;               |             taxon             |
## +===================================+===============================+
## | **Genus:Ruminococcaceae_UCG-014** | Genus:Ruminococcaceae_UCG-014 |
## +-----------------------------------+-------------------------------+
## |      **Order:Bacteroidales**      |      Order:Bacteroidales      |
## +-----------------------------------+-------------------------------+
## |    **Genus:Faecalibacterium**     |    Genus:Faecalibacterium     |
## +-----------------------------------+-------------------------------+
## |       **Genus:Catabacter**        |       Genus:Catabacter        |
## +-----------------------------------+-------------------------------+
## |     **Genus:Butyricicoccus**      |     Genus:Butyricicoccus      |
## +-----------------------------------+-------------------------------+
## |   **Order:Gastranaerophilales**   |   Order:Gastranaerophilales   |
## +-----------------------------------+-------------------------------+</code></pre>
</div>
<div id="ancom-bc" class="section level2">
<h2><span class="header-section-number">8.3</span> ANCOM-BC</h2>
<p><a href="https://www.nature.com/articles/s41467-020-17041-7">The analysis of composition of microbiomes with bias correction (ANCOM-BC)</a>
is a recently developed method for differential abundance testing. It is based on an
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4450248/">earlier published approach</a>.
This method could be recommended as part of several approaches:
A <a href="https://www.biorxiv.org/content/10.1101/2021.05.10.443486v1.full">recent study</a>
compared several mainstream methods and found that among another method, ANCOM-BC produced
the most consistent results and is probably a conservative approach. Please note that
based on this and other comparisons, no single method can be recommended across all datasets.
Rather, it could be recommended to apply several methods and look at the overlap/differences.</p>
<p>As the only method, ANCOM-BC incorporates the so called <em>sampling fraction</em> into the model.
The latter term could be empirically estimated by the ratio of the library size to the microbial load.
Variations in this sampling fraction would bias differential abundance analyses if ignored.
Furthermore, this method provides p-values, and confidence intervals for each taxon.
It also controls the FDR and it is computationally simple to implement.</p>
<p>As we will see below, to obtain results, all that is needed is to pass
a phyloseq object to the <code>ancombc()</code> function. Therefore, below we first convert
our <code>tse</code> object to a <code>phyloseq</code> object. Then, we specify the formula. In this formula,
other covariates could potentially be included to adjust for confounding.
Please check the <a href="https://rdrr.io/github/FrederickHuangLin/ANCOMBC/man/ancombc.html">function documentation</a>
to learn about the additional arguments that we specify below.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="differential-abundance-analysis.html#cb73-1"></a><span class="co"># currently, ancombc requires the phyloseq format, but we can easily convert:</span></span>
<span id="cb73-2"><a href="differential-abundance-analysis.html#cb73-2"></a>pseq &lt;-<span class="st"> </span><span class="kw">makePhyloseqFromTreeSummarizedExperiment</span>(tse)</span>
<span id="cb73-3"><a href="differential-abundance-analysis.html#cb73-3"></a>pseq_genus &lt;-<span class="st"> </span>phyloseq<span class="op">::</span><span class="kw">tax_glom</span>(pseq, <span class="dt">taxrank =</span> <span class="st">&quot;Genus&quot;</span>)</span>
<span id="cb73-4"><a href="differential-abundance-analysis.html#cb73-4"></a></span>
<span id="cb73-5"><a href="differential-abundance-analysis.html#cb73-5"></a>out =<span class="st"> </span><span class="kw">ancombc</span>(</span>
<span id="cb73-6"><a href="differential-abundance-analysis.html#cb73-6"></a>  <span class="dt">phyloseq =</span> pseq_genus, </span>
<span id="cb73-7"><a href="differential-abundance-analysis.html#cb73-7"></a>  <span class="dt">formula =</span> <span class="st">&quot;patient_status&quot;</span>, </span>
<span id="cb73-8"><a href="differential-abundance-analysis.html#cb73-8"></a>  <span class="dt">p_adj_method =</span> <span class="st">&quot;holm&quot;</span>, </span>
<span id="cb73-9"><a href="differential-abundance-analysis.html#cb73-9"></a>  <span class="dt">zero_cut =</span> <span class="fl">0.90</span>, </span>
<span id="cb73-10"><a href="differential-abundance-analysis.html#cb73-10"></a>  <span class="dt">lib_cut =</span> <span class="dv">0</span>, </span>
<span id="cb73-11"><a href="differential-abundance-analysis.html#cb73-11"></a>  <span class="dt">group =</span> <span class="st">&quot;patient_status&quot;</span>, </span>
<span id="cb73-12"><a href="differential-abundance-analysis.html#cb73-12"></a>  <span class="dt">struc_zero =</span> <span class="ot">TRUE</span>, </span>
<span id="cb73-13"><a href="differential-abundance-analysis.html#cb73-13"></a>  <span class="dt">neg_lb =</span> <span class="ot">TRUE</span>, </span>
<span id="cb73-14"><a href="differential-abundance-analysis.html#cb73-14"></a>  <span class="dt">tol =</span> <span class="fl">1e-5</span>, </span>
<span id="cb73-15"><a href="differential-abundance-analysis.html#cb73-15"></a>  <span class="dt">max_iter =</span> <span class="dv">100</span>, </span>
<span id="cb73-16"><a href="differential-abundance-analysis.html#cb73-16"></a>  <span class="dt">conserve =</span> <span class="ot">TRUE</span>, </span>
<span id="cb73-17"><a href="differential-abundance-analysis.html#cb73-17"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb73-18"><a href="differential-abundance-analysis.html#cb73-18"></a>  <span class="dt">global =</span> <span class="ot">TRUE</span></span>
<span id="cb73-19"><a href="differential-abundance-analysis.html#cb73-19"></a>)</span>
<span id="cb73-20"><a href="differential-abundance-analysis.html#cb73-20"></a>res &lt;-<span class="st"> </span>out<span class="op">$</span>res</span></code></pre></div>
<p>The object <code>out</code> contains all relevant information. Again, see the
<a href="https://rdrr.io/github/FrederickHuangLin/ANCOMBC/man/ancombc.html">documentation of the function</a>
under <strong>Value</strong> for an explanation of all the output objects. Our question can be answered
by looking at the <code>res</code> object, which now contains dataframes with the coefficients,
standard errors, p-values and q-values. Conveniently, there is a dataframe <code>diff_abn</code>.
Here, we can find all differentiallt abundant taxa. Below we show the first 6 entries of this dataframe:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="differential-abundance-analysis.html#cb74-1"></a><span class="kw">pandoc.table</span>(<span class="kw">as.matrix</span>(<span class="kw">head</span>(res<span class="op">$</span>diff_abn)),<span class="dt">style=</span><span class="st">&quot;grid&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 
## +---------------+-----------------------+
## |    &amp;nbsp;     | patient_statusControl |
## +===============+=======================+
## | **172647198** |         FALSE         |
## +---------------+-----------------------+
## |  **1726478**  |         FALSE         |
## +---------------+-----------------------+
## | **172647201** |         FALSE         |
## +---------------+-----------------------+
## | **17264798**  |         FALSE         |
## +---------------+-----------------------+
## | **172647195** |         FALSE         |
## +---------------+-----------------------+
## |  **1726472**  |         FALSE         |
## +---------------+-----------------------+</code></pre>
<p>In total, this method detects 13 differentially abundant taxa.</p>
</div>
<div id="comparison-of-wilcoxon-test-and-deseq2" class="section level2">
<h2><span class="header-section-number">8.4</span> Comparison of Wilcoxon test and DESeq2</h2>
<p>Let’s compare results that we got from the Wilcoxon test and DESeq2.
As we can see from the scatter plot, DESeq2 gives lower p-values than Wilcoxon test.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="differential-abundance-analysis.html#cb76-1"></a>mf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df<span class="op">$</span>padj, wilcoxon_p<span class="op">$</span>p_adjusted)</span>
<span id="cb76-2"><a href="differential-abundance-analysis.html#cb76-2"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mf, <span class="kw">aes</span>(<span class="dt">x =</span> df<span class="op">$</span>padj, <span class="dt">y =</span> wilcoxon_p<span class="op">$</span>p_adjusted)) <span class="op">+</span></span>
<span id="cb76-3"><a href="differential-abundance-analysis.html#cb76-3"></a><span class="st">       </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;DESeq2 adjusted p-value&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wilcoxon test adjusted p-value&quot;</span>) <span class="op">+</span></span>
<span id="cb76-4"><a href="differential-abundance-analysis.html#cb76-4"></a><span class="st">       </span><span class="kw">geom_count</span>() <span class="op">+</span></span>
<span id="cb76-5"><a href="differential-abundance-analysis.html#cb76-5"></a><span class="st"> </span><span class="kw">scale_size_area</span>(<span class="dt">max_size =</span> <span class="dv">10</span>)</span>
<span id="cb76-6"><a href="differential-abundance-analysis.html#cb76-6"></a></span>
<span id="cb76-7"><a href="differential-abundance-analysis.html#cb76-7"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="radboud2021_material_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Prints number of p-values under 0.05</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="differential-abundance-analysis.html#cb77-1"></a><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;DESeq2 p-values under 0.05: &quot;</span>, <span class="kw">sum</span>(df<span class="op">$</span>padj<span class="op">&lt;</span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="st">&quot;/&quot;</span>, <span class="kw">length</span>(df<span class="op">$</span>padj)))</span></code></pre></div>
<pre><code>## [1] &quot;DESeq2 p-values under 0.05: 7/54&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="differential-abundance-analysis.html#cb79-1"></a><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Wilcoxon test p-values under 0.05: &quot;</span>, </span>
<span id="cb79-2"><a href="differential-abundance-analysis.html#cb79-2"></a>             <span class="kw">sum</span>(wilcoxon_p<span class="op">$</span>p_adjusted<span class="op">&lt;</span><span class="fl">0.05</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="st">&quot;/&quot;</span>, <span class="kw">length</span>(wilcoxon_p<span class="op">$</span>p_adjusted)))</span></code></pre></div>
<pre><code>## [1] &quot;Wilcoxon test p-values under 0.05: 2/54&quot;</code></pre>
</div>
<div id="comparison-of-abundance" class="section level2">
<h2><span class="header-section-number">8.5</span> Comparison of abundance</h2>
<p>In previous steps, we got information which taxa vary between ADHD and control groups.
Let’s plot those taxa in the boxplot, and compare visually if abundances of those taxa
differ in ADHD and control samples. For comparison, let’s plot also taxa that do not
differ between ADHD and control groups.</p>
<p>Let’s first gather data about taxa that have highest p-values.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="differential-abundance-analysis.html#cb81-1"></a><span class="co"># There are some taxa that do not include Genus level information. They are</span></span>
<span id="cb81-2"><a href="differential-abundance-analysis.html#cb81-2"></a><span class="co"># excluded from analysis.</span></span>
<span id="cb81-3"><a href="differential-abundance-analysis.html#cb81-3"></a><span class="co"># str_detect finds if the pattern is present in values of &quot;taxon&quot; column.</span></span>
<span id="cb81-4"><a href="differential-abundance-analysis.html#cb81-4"></a><span class="co"># Subset is taken, only those rows are included that do not include the pattern.</span></span>
<span id="cb81-5"><a href="differential-abundance-analysis.html#cb81-5"></a>df &lt;-<span class="st"> </span>df[ <span class="op">!</span>stringr<span class="op">::</span><span class="kw">str_detect</span>(df<span class="op">$</span>taxon, <span class="st">&quot;Genus:uncultured&quot;</span>), ]</span>
<span id="cb81-6"><a href="differential-abundance-analysis.html#cb81-6"></a></span>
<span id="cb81-7"><a href="differential-abundance-analysis.html#cb81-7"></a><span class="co"># Sorts p-values in decreasing order. Takes 3rd first ones. Takes those rows that match</span></span>
<span id="cb81-8"><a href="differential-abundance-analysis.html#cb81-8"></a><span class="co"># with p-values. Takes taxa. </span></span>
<span id="cb81-9"><a href="differential-abundance-analysis.html#cb81-9"></a>highest3 &lt;-<span class="st"> </span>df[df<span class="op">$</span>padj <span class="op">%in%</span><span class="st"> </span><span class="kw">sort</span>(df<span class="op">$</span>padj, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], ]<span class="op">$</span>taxon</span>
<span id="cb81-10"><a href="differential-abundance-analysis.html#cb81-10"></a></span>
<span id="cb81-11"><a href="differential-abundance-analysis.html#cb81-11"></a><span class="co"># From clr transformed table, takes only those taxa that had highest p-values</span></span>
<span id="cb81-12"><a href="differential-abundance-analysis.html#cb81-12"></a>highest3 &lt;-<span class="st"> </span><span class="kw">assay</span>(tse_genus, <span class="st">&quot;clr&quot;</span>)[highest3, ]</span>
<span id="cb81-13"><a href="differential-abundance-analysis.html#cb81-13"></a></span>
<span id="cb81-14"><a href="differential-abundance-analysis.html#cb81-14"></a><span class="co"># Transposes the table</span></span>
<span id="cb81-15"><a href="differential-abundance-analysis.html#cb81-15"></a>highest3 &lt;-<span class="st"> </span><span class="kw">t</span>(highest3)</span>
<span id="cb81-16"><a href="differential-abundance-analysis.html#cb81-16"></a></span>
<span id="cb81-17"><a href="differential-abundance-analysis.html#cb81-17"></a><span class="co"># Adds colData that includes patient status infomation</span></span>
<span id="cb81-18"><a href="differential-abundance-analysis.html#cb81-18"></a>highest3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(highest3, <span class="kw">as.data.frame</span>(<span class="kw">colData</span>(tse_genus)))</span>
<span id="cb81-19"><a href="differential-abundance-analysis.html#cb81-19"></a></span>
<span id="cb81-20"><a href="differential-abundance-analysis.html#cb81-20"></a><span class="co"># Some taxa names are that long that they don&#39;t fit nicely into title. So let&#39;s add there </span></span>
<span id="cb81-21"><a href="differential-abundance-analysis.html#cb81-21"></a><span class="co"># a line break after e.g. &quot;Genus&quot;. Here the dot after e.g. Genus is replaced with </span></span>
<span id="cb81-22"><a href="differential-abundance-analysis.html#cb81-22"></a><span class="co"># &quot;: \n&quot;</span></span>
<span id="cb81-23"><a href="differential-abundance-analysis.html#cb81-23"></a><span class="kw">colnames</span>(highest3)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">colnames</span>(highest3)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="cf">function</span>(x){</span>
<span id="cb81-24"><a href="differential-abundance-analysis.html#cb81-24"></a>  <span class="co"># Replaces the first dot</span></span>
<span id="cb81-25"><a href="differential-abundance-analysis.html#cb81-25"></a>  temp &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace</span>(x, <span class="st">&quot;[.]&quot;</span>, <span class="st">&quot;: &quot;</span>)</span>
<span id="cb81-26"><a href="differential-abundance-analysis.html#cb81-26"></a>  </span>
<span id="cb81-27"><a href="differential-abundance-analysis.html#cb81-27"></a>  <span class="co"># Replace all other dots and underscores with space</span></span>
<span id="cb81-28"><a href="differential-abundance-analysis.html#cb81-28"></a>  temp &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(temp, <span class="kw">c</span>(<span class="st">&quot;[.]&quot;</span> =<span class="st"> &quot; &quot;</span>, <span class="st">&quot;_&quot;</span> =<span class="st"> &quot; &quot;</span>))</span>
<span id="cb81-29"><a href="differential-abundance-analysis.html#cb81-29"></a>  </span>
<span id="cb81-30"><a href="differential-abundance-analysis.html#cb81-30"></a>  <span class="co"># Adds line break so that 25 characters is the maximal width</span></span>
<span id="cb81-31"><a href="differential-abundance-analysis.html#cb81-31"></a>  temp &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_wrap</span>(temp, <span class="dt">width =</span> <span class="dv">25</span>)</span>
<span id="cb81-32"><a href="differential-abundance-analysis.html#cb81-32"></a>})</span></code></pre></div>
<p>Next, let’s do the same but for taxa with lowest p-values.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="differential-abundance-analysis.html#cb82-1"></a><span class="co"># Sorts p-values in increasing order. Takes 3rd first ones. Takes those rows that match</span></span>
<span id="cb82-2"><a href="differential-abundance-analysis.html#cb82-2"></a><span class="co"># with p-values. Takes taxa. </span></span>
<span id="cb82-3"><a href="differential-abundance-analysis.html#cb82-3"></a>lowest3 &lt;-<span class="st"> </span>df[df<span class="op">$</span>padj <span class="op">%in%</span><span class="st"> </span><span class="kw">sort</span>(df<span class="op">$</span>padj, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], ]<span class="op">$</span>taxon</span>
<span id="cb82-4"><a href="differential-abundance-analysis.html#cb82-4"></a></span>
<span id="cb82-5"><a href="differential-abundance-analysis.html#cb82-5"></a><span class="co"># From clr transformed table, takes only those taxa that had lowest p-values</span></span>
<span id="cb82-6"><a href="differential-abundance-analysis.html#cb82-6"></a>lowest3 &lt;-<span class="kw">assay</span>(tse_genus, <span class="st">&quot;clr&quot;</span>)[lowest3, ]</span>
<span id="cb82-7"><a href="differential-abundance-analysis.html#cb82-7"></a></span>
<span id="cb82-8"><a href="differential-abundance-analysis.html#cb82-8"></a><span class="co"># Transposes the table</span></span>
<span id="cb82-9"><a href="differential-abundance-analysis.html#cb82-9"></a>lowest3 &lt;-<span class="st"> </span><span class="kw">t</span>(lowest3)</span>
<span id="cb82-10"><a href="differential-abundance-analysis.html#cb82-10"></a></span>
<span id="cb82-11"><a href="differential-abundance-analysis.html#cb82-11"></a><span class="co"># Adds colData that includes patient status infomation</span></span>
<span id="cb82-12"><a href="differential-abundance-analysis.html#cb82-12"></a>lowest3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(lowest3, <span class="kw">as.data.frame</span>(<span class="kw">colData</span>(tse_genus)))</span>
<span id="cb82-13"><a href="differential-abundance-analysis.html#cb82-13"></a></span>
<span id="cb82-14"><a href="differential-abundance-analysis.html#cb82-14"></a><span class="co"># Some taxa names are that long that they don&#39;t fit nicely into title. So let&#39;s add there </span></span>
<span id="cb82-15"><a href="differential-abundance-analysis.html#cb82-15"></a><span class="co"># a line break after e.g. &quot;Genus&quot;. Here the dot after e.g. Genus is replaced with </span></span>
<span id="cb82-16"><a href="differential-abundance-analysis.html#cb82-16"></a><span class="co"># &quot;: \n&quot;</span></span>
<span id="cb82-17"><a href="differential-abundance-analysis.html#cb82-17"></a><span class="kw">colnames</span>(lowest3)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">colnames</span>(lowest3)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="cf">function</span>(x){</span>
<span id="cb82-18"><a href="differential-abundance-analysis.html#cb82-18"></a>  <span class="co"># Replaces the first dot</span></span>
<span id="cb82-19"><a href="differential-abundance-analysis.html#cb82-19"></a>  temp &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace</span>(x, <span class="st">&quot;[.]&quot;</span>, <span class="st">&quot;: &quot;</span>)</span>
<span id="cb82-20"><a href="differential-abundance-analysis.html#cb82-20"></a>  </span>
<span id="cb82-21"><a href="differential-abundance-analysis.html#cb82-21"></a>  <span class="co"># Replace all other dots and underscores with space</span></span>
<span id="cb82-22"><a href="differential-abundance-analysis.html#cb82-22"></a>  temp &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(temp, <span class="kw">c</span>(<span class="st">&quot;[.]&quot;</span> =<span class="st"> &quot; &quot;</span>, <span class="st">&quot;_&quot;</span> =<span class="st"> &quot; &quot;</span>))</span>
<span id="cb82-23"><a href="differential-abundance-analysis.html#cb82-23"></a>  </span>
<span id="cb82-24"><a href="differential-abundance-analysis.html#cb82-24"></a>  <span class="co"># Adds line break so that 25 characters is the maximal width</span></span>
<span id="cb82-25"><a href="differential-abundance-analysis.html#cb82-25"></a>  temp &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_wrap</span>(temp, <span class="dt">width =</span> <span class="dv">25</span>)</span>
<span id="cb82-26"><a href="differential-abundance-analysis.html#cb82-26"></a>})</span></code></pre></div>
<p>Then we can plot these six different taxa. Let’s arrange them into the same picture.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="differential-abundance-analysis.html#cb83-1"></a><span class="co"># Puts plots in the same picture</span></span>
<span id="cb83-2"><a href="differential-abundance-analysis.html#cb83-2"></a>gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(</span>
<span id="cb83-3"><a href="differential-abundance-analysis.html#cb83-3"></a>  </span>
<span id="cb83-4"><a href="differential-abundance-analysis.html#cb83-4"></a>  <span class="co"># Plot 1</span></span>
<span id="cb83-5"><a href="differential-abundance-analysis.html#cb83-5"></a>  <span class="kw">ggplot</span>(highest3, <span class="kw">aes</span>(<span class="dt">x =</span> patient_status, <span class="dt">y =</span> highest3[,<span class="dv">1</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-6"><a href="differential-abundance-analysis.html#cb83-6"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-7"><a href="differential-abundance-analysis.html#cb83-7"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;CLR abundances&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y axis title</span></span>
<span id="cb83-8"><a href="differential-abundance-analysis.html#cb83-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">names</span>(highest3)[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="co"># main title</span></span>
<span id="cb83-9"><a href="differential-abundance-analysis.html#cb83-9"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-10"><a href="differential-abundance-analysis.html#cb83-10"></a>          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-11"><a href="differential-abundance-analysis.html#cb83-11"></a>          <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()), <span class="co"># makes titles smaller, removes x axis title</span></span>
<span id="cb83-12"><a href="differential-abundance-analysis.html#cb83-12"></a>  </span>
<span id="cb83-13"><a href="differential-abundance-analysis.html#cb83-13"></a>  <span class="co"># Plot 2</span></span>
<span id="cb83-14"><a href="differential-abundance-analysis.html#cb83-14"></a>  <span class="kw">ggplot</span>(highest3, <span class="kw">aes</span>(<span class="dt">x =</span> patient_status, <span class="dt">y =</span> highest3[,<span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-15"><a href="differential-abundance-analysis.html#cb83-15"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-16"><a href="differential-abundance-analysis.html#cb83-16"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;CLR abundances&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y axis title</span></span>
<span id="cb83-17"><a href="differential-abundance-analysis.html#cb83-17"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">names</span>(highest3)[<span class="dv">2</span>]) <span class="op">+</span><span class="st"> </span><span class="co"># main title</span></span>
<span id="cb83-18"><a href="differential-abundance-analysis.html#cb83-18"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-19"><a href="differential-abundance-analysis.html#cb83-19"></a>          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-20"><a href="differential-abundance-analysis.html#cb83-20"></a>          <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()), <span class="co"># makes titles smaller, removes x axis title</span></span>
<span id="cb83-21"><a href="differential-abundance-analysis.html#cb83-21"></a>  </span>
<span id="cb83-22"><a href="differential-abundance-analysis.html#cb83-22"></a>  <span class="co"># Plot 3</span></span>
<span id="cb83-23"><a href="differential-abundance-analysis.html#cb83-23"></a>  <span class="kw">ggplot</span>(highest3, <span class="kw">aes</span>(<span class="dt">x =</span> patient_status, <span class="dt">y =</span> highest3[,<span class="dv">3</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-24"><a href="differential-abundance-analysis.html#cb83-24"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-25"><a href="differential-abundance-analysis.html#cb83-25"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;CLR abundances&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y axis title</span></span>
<span id="cb83-26"><a href="differential-abundance-analysis.html#cb83-26"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">names</span>(highest3)[<span class="dv">3</span>]) <span class="op">+</span><span class="st"> </span><span class="co"># main title</span></span>
<span id="cb83-27"><a href="differential-abundance-analysis.html#cb83-27"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-28"><a href="differential-abundance-analysis.html#cb83-28"></a>          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-29"><a href="differential-abundance-analysis.html#cb83-29"></a>          <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()), <span class="co"># makes titles smaller, removes x axis title</span></span>
<span id="cb83-30"><a href="differential-abundance-analysis.html#cb83-30"></a>  </span>
<span id="cb83-31"><a href="differential-abundance-analysis.html#cb83-31"></a>  <span class="co"># Plot 4</span></span>
<span id="cb83-32"><a href="differential-abundance-analysis.html#cb83-32"></a>  <span class="kw">ggplot</span>(lowest3, <span class="kw">aes</span>(<span class="dt">x =</span> patient_status, <span class="dt">y =</span> lowest3[,<span class="dv">1</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-33"><a href="differential-abundance-analysis.html#cb83-33"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-34"><a href="differential-abundance-analysis.html#cb83-34"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;CLR abundances&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y axis title</span></span>
<span id="cb83-35"><a href="differential-abundance-analysis.html#cb83-35"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">names</span>(lowest3)[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="co"># main title</span></span>
<span id="cb83-36"><a href="differential-abundance-analysis.html#cb83-36"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-37"><a href="differential-abundance-analysis.html#cb83-37"></a>          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-38"><a href="differential-abundance-analysis.html#cb83-38"></a>          <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()), <span class="co"># makes titles smaller, removes x axis title</span></span>
<span id="cb83-39"><a href="differential-abundance-analysis.html#cb83-39"></a>  </span>
<span id="cb83-40"><a href="differential-abundance-analysis.html#cb83-40"></a>  <span class="co"># Plot 5</span></span>
<span id="cb83-41"><a href="differential-abundance-analysis.html#cb83-41"></a>  <span class="kw">ggplot</span>(lowest3, <span class="kw">aes</span>(<span class="dt">x =</span> patient_status, <span class="dt">y =</span> lowest3[,<span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-42"><a href="differential-abundance-analysis.html#cb83-42"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-43"><a href="differential-abundance-analysis.html#cb83-43"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;CLR abundances&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y axis title</span></span>
<span id="cb83-44"><a href="differential-abundance-analysis.html#cb83-44"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">names</span>(lowest3)[<span class="dv">2</span>]) <span class="op">+</span><span class="st"> </span><span class="co"># main title</span></span>
<span id="cb83-45"><a href="differential-abundance-analysis.html#cb83-45"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-46"><a href="differential-abundance-analysis.html#cb83-46"></a>          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-47"><a href="differential-abundance-analysis.html#cb83-47"></a>          <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()), <span class="co"># makes titles smaller, removes x axis title</span></span>
<span id="cb83-48"><a href="differential-abundance-analysis.html#cb83-48"></a>  </span>
<span id="cb83-49"><a href="differential-abundance-analysis.html#cb83-49"></a>  <span class="co"># Plot 6</span></span>
<span id="cb83-50"><a href="differential-abundance-analysis.html#cb83-50"></a>  <span class="kw">ggplot</span>(lowest3, <span class="kw">aes</span>(<span class="dt">x =</span> patient_status, <span class="dt">y =</span> lowest3[,<span class="dv">3</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-51"><a href="differential-abundance-analysis.html#cb83-51"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-52"><a href="differential-abundance-analysis.html#cb83-52"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;CLR abundances&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># y axis title</span></span>
<span id="cb83-53"><a href="differential-abundance-analysis.html#cb83-53"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">names</span>(lowest3)[<span class="dv">3</span>]) <span class="op">+</span><span class="st"> </span><span class="co"># main title</span></span>
<span id="cb83-54"><a href="differential-abundance-analysis.html#cb83-54"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-55"><a href="differential-abundance-analysis.html#cb83-55"></a>          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>),</span>
<span id="cb83-56"><a href="differential-abundance-analysis.html#cb83-56"></a>          <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>()), <span class="co"># makes titles smaller, removes x axis title</span></span>
<span id="cb83-57"><a href="differential-abundance-analysis.html#cb83-57"></a>  </span>
<span id="cb83-58"><a href="differential-abundance-analysis.html#cb83-58"></a>  <span class="co"># 3 columns and 2 rows</span></span>
<span id="cb83-59"><a href="differential-abundance-analysis.html#cb83-59"></a>  <span class="dt">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb83-60"><a href="differential-abundance-analysis.html#cb83-60"></a>  <span class="dt">nrow =</span> <span class="dv">2</span></span>
<span id="cb83-61"><a href="differential-abundance-analysis.html#cb83-61"></a>)</span></code></pre></div>
<p><img src="radboud2021_material_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="beta-diversity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="study-material.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["radboud2021_material.pdf"],
"toc": {
"collapse": "section",
"download": "PDF",
"sharing": {
"github": true,
"twitter": true,
"facebook": false,
"linkedin": true
},
"toolbar": {
"position": "fixed"
},
"search": true
}
});
});
</script>

</body>

</html>
